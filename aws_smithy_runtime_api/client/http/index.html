<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="HTTP clients and connectors"><title>aws_smithy_runtime_api::client::http - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-9ee3a5e31a2afa3e.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="aws_smithy_runtime_api" data-themes="" data-resource-suffix="" data-rustdoc-version="1.75.0 (82e1608df 2023-12-21)" data-channel="1.75.0" data-search-js="search-8fbf244ebcf71464.js" data-settings-js="settings-74424d7eec62a23e.js" ><script src="../../../static.files/storage-fec3eaa3851e447d.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-9dd44ab47b99a0fb.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-5d8b3c7633ad77ba.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../aws_smithy_runtime_api/index.html">aws_smithy_runtime_api</a><span class="version">1.1.7</span></h2></div><h2 class="location"><a href="#">Module http</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></section><h2><a href="../index.html">In aws_smithy_runtime_api::client</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">aws_smithy_runtime_api</a>::<wbr><a href="../index.html">client</a>::<wbr><a class="mod" href="#">http</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../../src/aws_smithy_runtime_api/client/http.rs.html#6-301">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>HTTP clients and connectors</p>
<h2 id="what-is-a-connector"><a href="#what-is-a-connector">What is a connector?</a></h2>
<p>When we talk about connectors, we are referring to the <a href="trait.HttpConnector.html" title="trait aws_smithy_runtime_api::client::http::HttpConnector"><code>HttpConnector</code></a> trait, and implementations of
that trait. This trait simply takes a HTTP request, and returns a future with the response for that
request.</p>
<p>This is slightly different from what a connector is in other libraries such as
<a href="https://crates.io/crates/hyper"><code>hyper</code></a>. In hyper 0.x, the connector is a <a href="https://crates.io/crates/tower"><code>tower</code></a> <code>Service</code> that takes a <code>Uri</code> and returns
a future with something that implements <code>AsyncRead + AsyncWrite</code>.</p>
<p>The <a href="trait.HttpConnector.html" title="trait aws_smithy_runtime_api::client::http::HttpConnector"><code>HttpConnector</code></a> is designed to be a layer on top of
whole HTTP libraries, such as hyper, which allows Smithy clients to be agnostic to the underlying HTTP
transport layer. This also makes it easy to write tests with a fake HTTP connector, and several
such test connector implementations are available in <a href="https://crates.io/crates/aws-smithy-runtime"><code>aws-smithy-runtime</code></a>
with the <code>test-util</code> feature enabled.</p>
<h2 id="responsibilities-of-a-connector"><a href="#responsibilities-of-a-connector">Responsibilities of a connector</a></h2>
<p>A connector primarily makes HTTP requests, but is also the place where connect and read timeouts are
implemented. The <code>HyperConnector</code> in <a href="https://crates.io/crates/aws-smithy-runtime"><code>aws-smithy-runtime</code></a> is an example where timeouts are implemented
as part of the connector.</p>
<p>Connectors are also responsible for DNS lookup, TLS, connection reuse, pooling, and eviction.
The Smithy clients have no knowledge of such concepts.</p>
<h2 id="the-httpclient-trait"><a href="#the-httpclient-trait">The <code>HttpClient</code> trait</a></h2>
<p>Connectors allow us to make requests, but we need a layer on top of connectors so that we can handle
varying connector settings. For example, say we configure some default HTTP connect/read timeouts on
Client, and then configure some override connect/read timeouts for a specific operation. These timeouts
ultimately are part of the connector, so the same connector can’t be reused for the two different sets
of timeouts. Thus, the <a href="trait.HttpClient.html" title="trait aws_smithy_runtime_api::client::http::HttpClient"><code>HttpClient</code></a> implementation is responsible for managing multiple connectors
with varying config. Some example configs that can impact which connector is used:</p>
<ul>
<li>HTTP protocol versions</li>
<li>TLS settings</li>
<li>Timeouts</li>
</ul>
<p>Some of these aren’t implemented yet, but they will appear in the <a href="struct.HttpConnectorSettings.html" title="struct aws_smithy_runtime_api::client::http::HttpConnectorSettings"><code>HttpConnectorSettings</code></a> struct
once they are.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.HttpConnectorFuture.html" title="struct aws_smithy_runtime_api::client::http::HttpConnectorFuture">HttpConnectorFuture</a></div><div class="desc docblock-short">Future for <a href="trait.HttpConnector.html#tymethod.call" title="method aws_smithy_runtime_api::client::http::HttpConnector::call"><code>HttpConnector::call</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.HttpConnectorSettings.html" title="struct aws_smithy_runtime_api::client::http::HttpConnectorSettings">HttpConnectorSettings</a></div><div class="desc docblock-short">Settings for HTTP Connectors</div></li><li><div class="item-name"><a class="struct" href="struct.HttpConnectorSettingsBuilder.html" title="struct aws_smithy_runtime_api::client::http::HttpConnectorSettingsBuilder">HttpConnectorSettingsBuilder</a></div><div class="desc docblock-short">Builder for <a href="struct.HttpConnectorSettings.html" title="struct aws_smithy_runtime_api::client::http::HttpConnectorSettings"><code>HttpConnectorSettings</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.SharedHttpClient.html" title="struct aws_smithy_runtime_api::client::http::SharedHttpClient">SharedHttpClient</a></div><div class="desc docblock-short">Shared HTTP client for use across multiple clients and requests.</div></li><li><div class="item-name"><a class="struct" href="struct.SharedHttpConnector.html" title="struct aws_smithy_runtime_api::client::http::SharedHttpConnector">SharedHttpConnector</a></div><div class="desc docblock-short">A shared <a href="trait.HttpConnector.html" title="trait aws_smithy_runtime_api::client::http::HttpConnector"><code>HttpConnector</code></a> implementation.</div></li></ul><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.HttpClient.html" title="trait aws_smithy_runtime_api::client::http::HttpClient">HttpClient</a></div><div class="desc docblock-short">HTTP client abstraction.</div></li><li><div class="item-name"><a class="trait" href="trait.HttpConnector.html" title="trait aws_smithy_runtime_api::client::http::HttpConnector">HttpConnector</a></div><div class="desc docblock-short">Trait with a <code>call</code> function that asynchronously converts a request into a response.</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.http_client_fn.html" title="fn aws_smithy_runtime_api::client::http::http_client_fn">http_client_fn</a></div><div class="desc docblock-short">Returns a <a href="struct.SharedHttpClient.html" title="struct aws_smithy_runtime_api::client::http::SharedHttpClient"><code>SharedHttpClient</code></a> that calls the given <code>connector</code> function to select a HTTP connector.</div></li></ul></section></div></main></body></html>